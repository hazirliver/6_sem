confusionMatrix(table(k_means_clusters, real_clusters))
fit_k_medoids$clustering
# k-medoids
k_medoids_clusters <- fit_k_medoids$clustering
confusionMatrix(table(k_medoids_clusters, real_clusters))
set.seed(1234)
n <- 50
# Первый кластер
x1 <- rnorm(n, 0, 0.20)
y1 <- rnorm(n, 0, 0.20)
# Второй кластер
x2 <- rnorm(n-5, 0.6, 0.25)
y2 <- rnorm(n-5, 0.6, 0.25)
# Выборсы для второго кластера
x2_outliers <- rnorm(5, 1, 0.1)
y2_outliers <- rnorm(5, 3, 0.1)
x2 <- c(x2, x2_outliers)
y2 <- c(y2, y2_outliers)
df <- data.frame(x = c(x1,x2), y = c(y1,y2),
clus = factor(c(rep(1,n), rep(3,n-5), rep(2,5)), labels = c("1 clus", "2d clus outliers", "2nd clus")))
# Верно раскрашенные данные
ggplot(df, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
set.seed(1234)
n <- 20
# Первый кластер
x1 <- rnorm(n, 0, 0.20)
y1 <- rnorm(n, 0, 0.20)
# Второй кластер
x2 <- rnorm(n-3, 0.6, 0.25)
y2 <- rnorm(n-3, 0.6, 0.25)
# Выборсы для второго кластера
x2_outliers <- rnorm(3, 1, 0.1)
y2_outliers <- rnorm(3, 3, 0.1)
x2 <- c(x2, x2_outliers)
y2 <- c(y2, y2_outliers)
df <- data.frame(x = c(x1,x2), y = c(y1,y2),
clus = factor(c(rep(1,n), rep(3,n-5), rep(2,5)), labels = c("1 clus", "2d clus outliers", "2nd clus")))
# Верно раскрашенные данные
ggplot(df, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
# k-means
set.seed(1234)
n <- 20
# Первый кластер
x1 <- rnorm(n, 0, 0.20)
y1 <- rnorm(n, 0, 0.20)
# Второй кластер
x2 <- rnorm(n-3, 0.6, 0.25)
y2 <- rnorm(n-3, 0.6, 0.25)
# Выборсы для второго кластера
x2_outliers <- rnorm(3, 1, 0.1)
y2_outliers <- rnorm(3, 3, 0.1)
x2 <- c(x2, x2_outliers)
y2 <- c(y2, y2_outliers)
df <- data.frame(x = c(x1,x2), y = c(y1,y2),
clus = factor(c(rep(1,n), rep(3,n-3), rep(2,3)), labels = c("1 clus", "2d clus outliers", "2nd clus")))
# Верно раскрашенные данные
ggplot(df, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
# k-means
fit_k_means <- kmeans(df[,-3], 2)
ggplot(df, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
# k-medoids
fit_k_medoids <- pam(df[,-3], 2)
ggplot(df, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
real_clusters <- as.numeric(df$clus)
real_clusters[real_clusters == 3] <- 2
# k-means
old <- c(2,1)
new <- c(1,2)
k_means_clusters <- new[match(fit_k_means$cluster, old)]
k_means_clusters == real_clusters
confusionMatrix(table(k_means_clusters, real_clusters))
# k-medoids
k_medoids_clusters <- fit_k_medoids$clustering
confusionMatrix(table(k_medoids_clusters, real_clusters))
ggplot(df, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
ggplot(df, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
confusionMatrix(table(k_means_clusters, real_clusters))
confusionMatrix(table(k_medoids_clusters, real_clusters))
k_means_clusters
real_clusters
real_clusters <- as.numeric(df$clus)
real_clusters[real_clusters == 3] <- 2
k_means_clusters
real_clusters
# k-means
old <- c(2,1)
new <- c(1,2)
k_means_clusters <- new[match(fit_k_means$cluster, old)]
k_means_clusters
fit_k_means$cluster
k_means_clusters <- fit_k_means$cluster
confusionMatrix(table(k_means_clusters, real_clusters))
# k-medoids
k_medoids_clusters <- fit_k_medoids$clustering
confusionMatrix(table(k_medoids_clusters, real_clusters))
set.seed(1234)
n <- 20
# Первый кластер
x1 <- rnorm(n, 0, 0.20)
y1 <- rnorm(n, 0, 0.20)
# Второй кластер
x2 <- rnorm(n-3, 0.6, 0.25)
y2 <- rnorm(n-3, 0.6, 0.25)
# Выборсы для второго кластера
x2_outliers <- rnorm(3, 1.5, 0.1)
y2_outliers <- rnorm(3, 3.5, 0.1)
x2 <- c(x2, x2_outliers)
y2 <- c(y2, y2_outliers)
df <- data.frame(x = c(x1,x2), y = c(y1,y2),
clus = factor(c(rep(1,n), rep(3,n-3), rep(2,3)), labels = c("1 clus", "2d clus outliers", "2nd clus")))
# Верно раскрашенные данные
ggplot(df, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
ggplot(df, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
ggplot(df, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
# k-means
fit_k_means <- kmeans(df[,-3], 2)
ggplot(df, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
set.seed(1234)
n <- 20
# Первый кластер
x1 <- rnorm(n, 0, 0.20)
y1 <- rnorm(n, 0, 0.20)
# Второй кластер
x2 <- rnorm(n-3, 0.6, 0.25)
y2 <- rnorm(n-3, 0.6, 0.25)
# Выборсы для второго кластера
x2_outliers <- rnorm(3, 1, 0.1)
y2_outliers <- rnorm(3, 3, 0.1)
x2 <- c(x2, x2_outliers)
y2 <- c(y2, y2_outliers)
df <- data.frame(x = c(x1,x2), y = c(y1,y2),
clus = factor(c(rep(1,n), rep(3,n-3), rep(2,3)), labels = c("1 clus", "2d clus outliers", "2nd clus")))
# Верно раскрашенные данные
ggplot(df, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
# k-means
fit_k_means <- kmeans(df[,-3], 2)
ggplot(df, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
ggplot(df, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
# k-medoids
fit_k_medoids <- pam(df[,-3], 2)
ggplot(df, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
real_clusters <- as.numeric(df$clus)
real_clusters[real_clusters == 3] <- 2
# k-means
old <- c(2,1)
new <- c(1,2)
# k-means
k_means_clusters <- fit_k_means$cluster
confusionMatrix(table(k_means_clusters, real_clusters))
# k-medoids
k_medoids_clusters <- fit_k_medoids$clustering
confusionMatrix(table(k_medoids_clusters, real_clusters))
table(k_medoids_clusters, real_clusters)
table(k_means_clusters, real_clusters)
# Верно раскрашенные данные
ggplot(df, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
png(filename = "../img/k-medoids/initial_data.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
dev.off()
png(filename = "../img/k-medoids/initial_data.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
dev.off()
png(filename = "../img/k-medoids/basic_k-means_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
dev.off()
png(filename = "../img/k-medoids/basic_k-means_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
dev.off()
png(filename = "../img/k-medoids/basic_k-means_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
dev.off()
png(filename = "../img/k-medoids/basic_k-medoids_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
dev.off()
set.seed(1234)
n <- 20
# Первый кластер
x1 <- rnorm(n, 0, 0.20)
y1 <- rnorm(n, 0, 0.20)
# Второй кластер
x2 <- rnorm(n-3, 0.6, 0.25)
y2 <- rnorm(n-3, 0.6, 0.25)
# Выборсы для второго кластера
x2_outliers <- rnorm(3, 1, 0.1)
y2_outliers <- rnorm(3, 3, 0.1)
x2_full <- c(x2, x2_outliers)
y2_full <- c(y2, y2_outliers)
# Датасет без выбросов
df_reduced <- data.frame(x = c(x1,x2), y = c(y1,y2),
clus = factor(c(rep(1,n), rep(3,n-3)), labels = c("1 clus","2nd clus")))
df_reduced
df_w_outliers <- data.frame(x = c(x1,x2_full), y = c(y1,y2_full),
clus = factor(c(rep(1,n), rep(3,n-3), rep(2,3)), labels = c("1 clus", "2d clus outliers", "2nd clus")))
df_w_outliers
set.seed(1234)
n <- 20
# Первый кластер
x1 <- rnorm(n, 0, 0.20)
y1 <- rnorm(n, 0, 0.20)
# Второй кластер
x2 <- rnorm(n-3, 0.6, 0.25)
y2 <- rnorm(n-3, 0.6, 0.25)
# Выборсы для второго кластера
x2_outliers <- rnorm(3, 1, 0.1)
y2_outliers <- rnorm(3, 3, 0.1)
x2_full <- c(x2, x2_outliers)
y2_full <- c(y2, y2_outliers)
# Датасет без выбросов
df_reduced <- data.frame(x = c(x1,x2), y = c(y1,y2),
clus = factor(c(rep(1,n), rep(3,n-3)), labels = c("1 clus","2nd clus")))
df_w_outliers <- data.frame(x = c(x1,x2_full), y = c(y1,y2_full),
clus = factor(c(rep(1,n), rep(3,n-3), rep(2,3)), labels = c("1 clus", "2d clus outliers", "2nd clus")))
# Верно раскрашенные данные
png(filename = "../img/k-medoids/initial_data.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
dev.off()
set.seed(1234)
n <- 20
# Первый кластер
x1 <- rnorm(n, 0, 0.20)
y1 <- rnorm(n, 0, 0.20)
# Второй кластер
x2 <- rnorm(n-3, 0.6, 0.25)
y2 <- rnorm(n-3, 0.6, 0.25)
# Выборсы для второго кластера
x2_outliers <- rnorm(3, 1, 0.1)
y2_outliers <- rnorm(3, 3, 0.1)
x2_full <- c(x2, x2_outliers)
y2_full <- c(y2, y2_outliers)
# Датасет без выбросов
df_reduced <- data.frame(x = c(x1,x2), y = c(y1,y2),
clus = factor(c(rep(1,n), rep(3,n-3)), labels = c("1 clus","2nd clus")))
df_w_outliers <- data.frame(x = c(x1,x2_full), y = c(y1,y2_full),
clus = factor(c(rep(1,n), rep(3,n-3), rep(2,3)), labels = c("1 clus", "2d clus outliers", "2nd clus")))
# Верно раскрашенные данные
png(filename = "../img/k-medoids/initial_data.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
dev.off()
# k-means
fit_k_means <- kmeans(df_w_outliers[,-3], 2)
png(filename = "../img/k-medoids/basic_k-means_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
dev.off()
# k-medoids
fit_k_medoids <- pam(df_w_outliers[,-3], 2)
png(filename = "../img/k-medoids/basic_k-medoids_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
dev.off()
real_clusters <- as.numeric(df_w_outliers$clus)
real_clusters[real_clusters == 3] <- 2
# k-means
k_means_clusters <- fit_k_means$cluster
confusionMatrix(table(k_means_clusters, real_clusters))
# k-medoids
k_medoids_clusters <- fit_k_medoids$clustering
confusionMatrix(table(k_medoids_clusters, real_clusters))
# k-means
fit_k_means <- kmeans(df_w_outliers[,-3], 2)
png(filename = "../img/k-medoids/basic_k-means_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
dev.off()
# k-medoids
fit_k_medoids <- pam(df_w_outliers[,-3], 2)
png(filename = "../img/k-medoids/basic_k-medoids_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
dev.off()
real_clusters <- as.numeric(df_w_outliers$clus)
real_clusters[real_clusters == 3] <- 2
# k-means
k_means_clusters <- fit_k_means$cluster
confusionMatrix(table(k_means_clusters, real_clusters))
# k-medoids
k_medoids_clusters <- fit_k_medoids$clustering
confusionMatrix(table(k_medoids_clusters, real_clusters))
# k-means
fit_k_means_outliers <- kmeans(df_reduced[,-3], 2)
png(filename = "../img/k-medoids/outliers_k-means_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_reduced, aes(x,y, color = as.factor(fit_k_means_outliers$cluster))) + geom_point() +
labs(color = "K-means clusters with outliers")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means_outliers$centers), aes(x,y), pch = 10, size = 7, col = "black")
dev.off()
# k-medoids
fit_k_medoids_outliers <- pam(df_reduced[,-3], 2)
png(filename = "../img/k-medoids/outliers_k-medoids_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_reduced, aes(x,y, color = as.factor(fit_k_medoids_outliers$clustering))) + geom_point() +
labs(color = "K-medoids clusters with outliers")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids_outliers$medoids), aes(x,y), pch = 19, size = 4, col = "black")
dev.off()
real_clusters <- as.numeric(df_reduced$clus)
real_clusters[real_clusters == 3] <- 2
# k-means
k_means_clusters_outliers <- fit_k_means_outliers$cluster
confusionMatrix(table(k_means_clusters_outliers, real_clusters))
# k-medoids
k_medoids_clusters <- fit_k_medoids_outliers$clustering
confusionMatrix(table(k_medoids_clusters_outliers, real_clusters))
k_medoids_clusters_outliers <- fit_k_medoids_outliers$clustering
confusionMatrix(table(k_medoids_clusters_outliers, real_clusters))
png(filename = "../img/k-medoids/initial_data_reduced.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_reduced, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
dev.off()
# k-means
fit_k_means_outliers <- kmeans(df_reduced[,-3], 2, algorithm = "MacQueen")
ggplot(df_reduced, aes(x,y, color = as.factor(fit_k_means_outliers$cluster))) + geom_point() +
labs(color = "K-means clusters with outliers")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means_outliers$centers), aes(x,y), pch = 10, size = 7, col = "black")
# Верно раскрашенные данные
png(filename = "../img/k-medoids/initial_data_reduced.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_reduced, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters without outliers") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
dev.off()
# k-means
fit_k_means_outliers <- kmeans(df_reduced[,-3], 2)
png(filename = "../img/k-medoids/outliers_k-means_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_reduced, aes(x,y, color = as.factor(fit_k_means_outliers$cluster))) + geom_point() +
labs(color = "K-means clusters without outliers")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means_outliers$centers), aes(x,y), pch = 10, size = 7, col = "black")
dev.off()
# k-medoids
fit_k_medoids_outliers <- pam(df_reduced[,-3], 2)
png(filename = "../img/k-medoids/outliers_k-medoids_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_reduced, aes(x,y, color = as.factor(fit_k_medoids_outliers$clustering))) + geom_point() +
labs(color = "K-medoids clusters without outliers")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids_outliers$medoids), aes(x,y), pch = 19, size = 4, col = "black")
dev.off()
real_clusters <- as.numeric(df_reduced$clus)
real_clusters[real_clusters == 3] <- 2
# k-means
k_means_clusters_outliers <- fit_k_means_outliers$cluster
confusionMatrix(table(k_means_clusters_outliers, real_clusters))
# k-medoids
k_medoids_clusters_outliers <- fit_k_medoids_outliers$clustering
confusionMatrix(table(k_medoids_clusters_outliers, real_clusters))
confusionMatrix(table(k_medoids_clusters, real_clusters), positive = c("precision", "recall"))
confusionMatrix(table(k_medoids_clusters, real_clusters), positive = "precision")
confusionMatrix(table(k_medoids_clusters, real_clusters), positive = T)
confusionMatrix(table(k_medoids_clusters, real_clusters), positive = "prec_recall")
confusionMatrix(table(k_medoids_clusters, real_clusters), positive = "positive")
table(k_medoids_clusters, real_clusters)
confusionMatrix(table(k_medoids_clusters, real_clusters), positive = "positive")
confusionMatrix(table(k_medoids_clusters, real_clusters), positive = "positive")
F_meas(table(k_medoids_clusters, real_clusters))
precision(table(k_medoids_clusters, real_clusters))
recall(table(k_medoids_clusters, real_clusters))
confusionMatrix(table(k_medoids_clusters, real_clusters))
confusionMatrix(table(k_means_clusters, real_clusters))
confusionMatrix(table(k_means_clusters, real_clusters))
confusionMatrix(table(k_means_clusters, real_clusters))
fit_k_means$cluster
# k-medoids
k_medoids_clusters <- fit_k_medoids$clustering
confusionMatrix(table(k_medoids_clusters, real_clusters))
# k-means
k_means_clusters <- fit_k_means$cluster
confusionMatrix(table(k_means_clusters, real_clusters))
real_clusters <- as.numeric(df_reduced$clus)
real_clusters[real_clusters == 3] <- 2
# k-means
k_means_clusters_outliers <- fit_k_means_outliers$cluster
confusionMatrix(table(k_means_clusters_outliers, real_clusters))
# k-medoids
k_medoids_clusters_outliers <- fit_k_medoids_outliers$clustering
confusionMatrix(table(k_medoids_clusters_outliers, real_clusters))
confusionMatrix(table(k_means_clusters_outliers, real_clusters))
confusionMatrix(table(k_medoids_clusters_outliers, real_clusters))
# Случай с выбросами
#----------------------------------------------------------------------------------------------------------------#
# Верно раскрашенные данные
png(filename = "../img/k-medoids/initial_data.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = clus)) + geom_point() + labs(color = "K-means clusters") +
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA))
dev.off()
# k-means
fit_k_means <- kmeans(df_w_outliers[,-3], 2)
png(filename = "../img/k-medoids/basic_k-means_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = as.factor(fit_k_means$cluster))) + geom_point() +
labs(color = "K-means clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_means$centers), aes(x,y), pch = 10, size = 7, col = "black")
dev.off()
# k-medoids
fit_k_medoids <- pam(df_w_outliers[,-3], 2)
png(filename = "../img/k-medoids/basic_k-medoids_clusters.png",
width = 853, height = 707,
res = 96 * 1.25)
ggplot(df_w_outliers, aes(x,y, color = as.factor(fit_k_medoids$clustering))) + geom_point() +
labs(color = "K-medoids clusters")+
theme(panel.background = element_blank(), panel.border = element_rect(colour = "black", fill=NA)) +
geom_point(data = as.data.frame(fit_k_medoids$medoids), aes(x,y), pch = 19, size = 4, col = "black")
dev.off()
real_clusters <- as.numeric(df_w_outliers$clus)
real_clusters[real_clusters == 3] <- 2
# k-means
k_means_clusters <- fit_k_means$cluster
confusionMatrix(table(k_means_clusters, real_clusters))
# k-medoids
k_medoids_clusters <- fit_k_medoids$clustering
confusionMatrix(table(k_medoids_clusters, real_clusters))
confusionMatrix(table(k_means_clusters, real_clusters))
confusionMatrix(table(k_medoids_clusters, real_clusters))
precision(table(k_means_clusters, real_clusters))
recall(table(k_means_clusters, real_clusters))
