install.packages("readxl")
library("")
library("readxl")
library(readxl)
read_xlsx("g_form.xlsx")
df <- read_xlsx("g_form.xlsx")
head(df)
df <- (read_xlsx("g_form.xlsx"))[-1,]
head(df)
df <- (read_xlsx("g_form.xlsx"))[,-1]
head(df)
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
head(df)
boxplot(df)
boxplot(df$`Бутылка колы (0.5)`)
boxplot(df$`Плитка шоколада (100 гр)`)
boxplot(df$`Чашка кофе (0.3)`)
boxplot(df$)
boxplot(df$`Часы наручные`)
boxplot(df)
df <- df[df$`Бутылка колы (0.5)` < 40]
df$`Бутылка колы (0.5)` < 40
df[df$`Бутылка колы (0.5)` < 40]
df <- df[,df$`Бутылка колы (0.5)` < 40]
df <- df[df$`Бутылка колы (0.5)` < 40,]
df
df <- df[df$`Плитка шоколада (100 гр)`< 40,]
df <- df[df$`Чашка кофе (0.3)` < 10,]
df <- df[df$`Часы наручные` < 3000,]
df <- df[df$Электросамокат < 5000,]
df <- df[df$`Крем для рук` < 50]
df
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
head(df)
df <- df[df$`Бутылка колы (0.5)` < 40,]
df <- df[df$`Плитка шоколада (100 гр)`< 40,]
df <- df[df$`Чашка кофе (0.3)` < 10,]
df <- df[df$`Часы наручные` < 3000,]
df <- df[df$Электросамокат < 5000,]
df <- df[df$`Крем для рук` < 50,]
df
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
df <- df[df$`Бутылка колы (0.5)` < 40,]
df
df <- df[df$`Плитка шоколада (100 гр)`< 40,]
df
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
head(df)
df <- df[df$`Бутылка колы (0.5)` > 40,]
df <- df[df$`Плитка шоколада (100 гр)`> 40,]
df <- df[df$`Чашка кофе (0.3)` > 10,]
df <- df[df$`Часы наручные` > 3000,]
df <- df[df$Электросамокат > 5000,]
df <- df[df$`Крем для рук` > 50,]
df
install.packages("ggstatsplot")
#install.packages("ggstatsplot")
library(ggstatsplot)
boxplot(df$`Плитка шоколада (100 гр)`)
ggbetweenstats(df$`Плитка шоколада (100 гр)`,
wool, breaks, outlier.tagging = TRUE)
ggbetweenstats(df$`Плитка шоколада (100 гр)`, outlier.tagging = TRUE)
ggbetweenstats(df,df$`Плитка шоколада (100 гр)` outlier.tagging = TRUE)
ggbetweenstats(df,df$`Плитка шоколада (100 гр)`, outlier.tagging = TRUE)
df
range(df$`Плитка шоколада (100 гр)`)
c(range(df$`Плитка шоколада (100 гр)`))
rng <- c(range(df$`Плитка шоколада (100 гр)`))
rng
ggbetweenstats(df,rng,df$`Плитка шоколада (100 гр)`, outlier.tagging = TRUE)
rlang::last_error()
ggbetweenstats(df,rng,`Плитка шоколада (100 гр)`, outlier.tagging = TRUE)
ggbetweenstats(df,x=rng,y=df$`Плитка шоколада (100 гр)`, outlier.tagging = TRUE)
ggbetweenstats(df$`Плитка шоколада (100 гр)`,x=rng,y=df$`Плитка шоколада (100 гр)`, outlier.tagging = TRUE)
ddd <- df$`Плитка шоколада (100 гр)`
ddd
len(df)
length(df)
dim(df)
df
ddd <- df$`Плитка шоколада (100 гр)`
ddd
ggbetweenstats(ddd)
ggbetweenstats(ddd, x = 1, y = ggbetweenstats)
ggbetweenstats(ddd, x = 1, y = ddd)
library(ggplot2)
p <- ggplot(ddd)
ddd <- data.frame(name = df$`Плитка шоколада (100 гр)`)
ddd
p <- ggplot(ddd)
p
p + geom_violin()
plot(ddd)
plot(ddd, aes(cut))
ggpplot(ddd, aes(cut))
gpplot(ddd, aes(cut))
ggplot(ddd, aes(cut))
ggplot(ddd, aes(name))
ggplot(ddd, aes(name))  + geom_violin()
density(ddd)
ddd
density(as.numeric(ddd))
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
df <- df[df$`Бутылка колы (0.5)` > 40,]
df <- df[df$`Плитка шоколада (100 гр)`> 30,]
df <- df[df$`Чашка кофе (0.3)` > 10,]
df <- df[df$`Часы наручные` > 3000,]
df <- df[df$Электросамокат > 5000,]
df <- df[df$`Крем для рук` > 50,]
dim(df)
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
View(df)
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
df[df$`Бутылка колы (0.5)` < 40,] <- 40
df[df$`Плитка шоколада (100 гр)` < 40,] <- 40
df[df$`Чашка кофе (0.3)` < 20,] <- 20
df[df$`Часы наручные` < 3000,] <- 3000
df[df$Электросамокат < 5000,] <- 5000
df[df$`Крем для рук` < 50,] <- 50
dim(df)
df
View(df)
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
df[df$`Бутылка колы (0.5)` < 40,] <- 40
df[df$`Бутылка колы (0.5)` < 40,]
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
df[df$`Бутылка колы (0.5)` < 40,]
df$`Бутылка колы (0.5)` < 40
df[df$`Бутылка колы (0.5)` < 40,1]
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
df[df$`Бутылка колы (0.5)` < 40,1] <- 40
df[df$`Чашка кофе (0.3)` < 20,3] <- 20
df[df$`Часы наручные` < 3000,4] <- 3000
df[df$`Плитка шоколада (100 гр)` < 40,2] <- 40
df[df$Электросамокат < 5000,5] <- 5000
df[df$`Крем для рук` < 50,6] <- 50
dim(df)
hist(df$`Плитка шоколада (100 гр)`)
## Оптовые цены
opt1 <- 5
opt2 <- 10
op3 <- 20
opt4 <- 30
opt5 <- 50
length(df$`Плитка шоколада (100 гр)`)
#
my_dat <- df$`Плитка шоколада (100 гр)`
stat_table <- data.frame(
N <- 1:length(my_dat)
)
stat_table
table(my_dat)
table(my_dat)[,1]
table(my_dat)[1]
t(table(my_dat))[1]
t(table(my_dat))
tabl <- table(my_dat)
tabl$1
tabl
colnames(tabl)
tabl <- as.matrix(table(my_dat))
tabl
colnames(tabl)
aggregate(my_dat)
aggregate(my_dat, length())
my_dat
aggregate(data.frame(count = mydat), list(value = mydat), length())
aggregate(data.frame(count = my_dat), list(value = my_dat), length())
aggregate(data.frame(count = my_dat), list(value = my_dat), length
aggregate(data.frame(count = my_dat), list(value = my_dat), length)
aggregate(data.frame(count = my_dat), list(value = my_dat), length)
tmp <- aggregate(data.frame(count = my_dat), list(value = my_dat), length)
tmp$count
cumsum(tmp$count)
stat_table <- data.frame(
p_i <- tmp$value,
f_i <- tmp$count,
D_i <- cumsum(tmp$count)
)
stat_table
stat_table <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = cumsum(tmp$count)
)
stat_table
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = cumsum(tmp$count)
)
otp_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
otp_1
stat_table <- data.frame(stat_table,
otp_1,otp_2,otp_3,otp_4,otp_5)
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
## Оптовые цены
opt1 <- 5
opt2 <- 10
opt3 <- 20
opt4 <- 30
opt5 <- 50
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
stat_table <- data.frame(stat_table,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table
stat_table[stat_table <= 0]
which(stat_table <= 0)
stat_table[which(stat_table <= 0)]
which(stat_table <= 0)
match(stat_table <= 0)
stat_table[match(stat_table <= 0, stat_table)]
match(stat_table <= 0, stat_table)
stat_table
stat_table$opt_5[stat_table$opt_5 <= 0] <- NA
stat_table
plot(stat_table$opt_1)
plot(stat_table$opt_1, stat_table$opt_2)
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = rev(cumsum(tmp$count))
)
stat_table <- data.frame(stat_table,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
head(df)
# Корректируем записи, в которых:
# Кола < 40
# Шокол < 40
# Кофе < 10
# Часы < 3000
# Самок < 5000
# Крем < 50
df[df$`Бутылка колы (0.5)` < 40,1] <- 40
df[df$`Плитка шоколада (100 гр)` < 40,2] <- 40
df[df$`Чашка кофе (0.3)` < 20,3] <- 20
df[df$`Часы наручные` < 3000,4] <- 3000
df[df$Электросамокат < 5000,5] <- 5000
df[df$`Крем для рук` < 50,6] <- 50
dim(df)
## Оптовые цены
opt1 <- 5
opt2 <- 10
opt3 <- 20
opt4 <- 30
opt5 <- 50
#
my_dat <- df$`Плитка шоколада (100 гр)`
tmp <- aggregate(data.frame(count = my_dat), list(value = my_dat), length)
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = rev(cumsum(tmp$count))
)
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
stat_table <- data.frame(stat_table,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table$opt_5[stat_table$opt_5 <= 0] <- NA
stat_table <- data.frame(stat_table_tmp,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table$opt_5[stat_table$opt_5 <= 0] <- NA
stat_table$opt_5[stat_table$opt_5 <= 0] <- NA
stat_table
plot(stat_table$opt_1, stat_table$opt_2)
my_dat[my_dat > 400] <- 400
tmp <- aggregate(data.frame(count = my_dat), list(value = my_dat), length)
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = rev(cumsum(tmp$count))
)
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
stat_table <- data.frame(stat_table_tmp,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table$opt_5[stat_table$opt_5 <= 0] <- NA
stat_table
plot(stat_table$opt_1, stat_table$opt_2)
stat_table[,4]
stat_table[,4:8]
max(range(stat_table[,4:8]))
range(stat_table[,4:8])
lapply(stat_table[,4:8], range)
max(range(stat_table[,4:8], na.rm = T))
min(range(stat_table[,4:8], na.rm = T))
min_pl <- max(range(stat_table[,4:8], na.rm = T))
max_pl <- max(range(stat_table[,4:8], na.rm = T))
min_pl <- min(range(stat_table[,4:8], na.rm = T))
ggplot( aes(x=min_pl:max_pl, y=stat_table[,4:8])) +
geom_line()
ggplot(stat_table, aes(x = min_pl:max_pl))+
geom_line(aes(y = opt_1), color = "#03A82F") +
geom_line(aes(y = opt_2), color = "#07728C") +
geom_line(aes(y = opt_3), color = "#E17204") +
geom_line(aes(y = opt_4), color = "#E11E04") +
geom_line(aes(y = opt_5), color = "#429DC7")
opt_1
ggplot(stat_table, aes(x = 1:17))+
geom_line(aes(y = opt_1), color = "#03A82F") +
geom_line(aes(y = opt_2), color = "#07728C") +
geom_line(aes(y = opt_3), color = "#E17204") +
geom_line(aes(y = opt_4), color = "#E11E04") +
geom_line(aes(y = opt_5), color = "#429DC7")
plot(x = stat_table$p_i, y = stat_table$D_i)
ggplot(stat_table, aes(x = 1:17))+
geom_line(aes(y = opt_1), color = "#03A82F") +
geom_line(aes(y = opt_2), color = "#07728C") +
geom_line(aes(y = opt_3), color = "#E17204") +
geom_line(aes(y = opt_4), color = "#E11E04") +
geom_line(aes(y = opt_5), color = "#429DC7")
ggplot(stat_table, aes(x = stat_table$p_i))+
geom_line(aes(y = opt_1), color = "#03A82F") +
geom_line(aes(y = opt_2), color = "#07728C") +
geom_line(aes(y = opt_3), color = "#E17204") +
geom_line(aes(y = opt_4), color = "#E11E04") +
geom_line(aes(y = opt_5), color = "#429DC7")
stat_table_tmp
stat_table
my_dat[my_dat >= 300] <- 300
tmp <- aggregate(data.frame(count = my_dat), list(value = my_dat), length)
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = rev(cumsum(tmp$count))
)
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
stat_table <- data.frame(stat_table_tmp,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table
max_pl <- max(range(stat_table[,4:8], na.rm = T))
min_pl <- min(range(stat_table[,4:8], na.rm = T))
stat_table$opt_5[stat_table$opt_5 <= 0] <- NA
ggplot(stat_table, aes(x = stat_table$p_i))+
geom_line(aes(y = opt_1), color = "#03A82F") +
geom_line(aes(y = opt_2), color = "#07728C") +
geom_line(aes(y = opt_3), color = "#E17204") +
geom_line(aes(y = opt_4), color = "#E11E04") +
geom_line(aes(y = opt_5), color = "#429DC7")
lapply(stat_table[,4:8], max)
lapply(stat_table[,4:8], max,na.rm = T)
View(stat_table)
#
my_dat <- df$`Плитка шоколада (100 гр)`
my_dat[my_dat >= 300] <- 300
tmp <- aggregate(data.frame(count = my_dat), list(value = my_dat), length)
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = rev(cumsum(tmp$count))
)
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
stat_table <- data.frame(stat_table_tmp,
opt_1,opt_2,opt_3,opt_4,opt_5)
df <- as.data.frame((read_xlsx("g_form.xlsx"))[,-1])
df[df$`Плитка шоколада (100 гр)` < 40,2] <- 40
## Оптовые цены
opt1 <- 5
opt2 <- 10
opt3 <- 20
opt4 <- 30
opt5 <- 50
#
my_dat <- df$`Плитка шоколада (100 гр)`
my_dat[my_dat >= 300] <- 300
tmp <- aggregate(data.frame(count = my_dat), list(value = my_dat), length)
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = rev(cumsum(tmp$count))
)
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
stat_table <- data.frame(stat_table_tmp,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table
tmp$count
cumsum(tmp$count)
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = cumsum(rev(tmp$count))
)
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
stat_table <- data.frame(stat_table_tmp,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table
stat_table_tmp <- data.frame(
p_i = tmp$value,
f_i = tmp$count,
D_i = rev(cumsum(rev(tmp$count)))
)
opt_1 <- (stat_table_tmp$p_i-opt1) * stat_table_tmp$D_i
opt_2 <- (stat_table_tmp$p_i-opt2) * stat_table_tmp$D_i
opt_3 <- (stat_table_tmp$p_i-opt3) * stat_table_tmp$D_i
opt_4 <- (stat_table_tmp$p_i-opt4) * stat_table_tmp$D_i
opt_5 <- (stat_table_tmp$p_i-opt5) * stat_table_tmp$D_i
stat_table <- data.frame(stat_table_tmp,
opt_1,opt_2,opt_3,opt_4,opt_5)
stat_table
stat_table$opt_5[stat_table$opt_5 <= 0] <- NA
lapply(stat_table[,4:8], max,na.rm = T)
max_pl <- max(range(stat_table[,4:8], na.rm = T))
min_pl <- min(range(stat_table[,4:8], na.rm = T))
ggplot(stat_table, aes(x = stat_table$p_i))+
geom_line(aes(y = opt_1), color = "#03A82F") +
geom_line(aes(y = opt_2), color = "#07728C") +
geom_line(aes(y = opt_3), color = "#E17204") +
geom_line(aes(y = opt_4), color = "#E11E04") +
geom_line(aes(y = opt_5), color = "#429DC7")
plot(x = stat_table$p_i, y = stat_table$D_i)
ggplot(stat_table, aes(x = stat_table$p_i))+
geom_line(aes(y = opt_1), color = "#03A82F") +
geom_line(aes(y = opt_2), color = "#07728C") +
geom_line(aes(y = opt_3), color = "#E17204") +
geom_line(aes(y = opt_4), color = "#E11E04") +
geom_line(aes(y = opt_5), color = "#429DC7")
plot(x = stat_table$p_i, y = stat_table$D_i)
stat_table
plot(x = stat_table$p_i, y = stat_table$D_i)
