try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.02)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.01)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.01)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.02)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.01)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.02)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.01)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.02)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.01)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.1, 0.1),
ylim = c(-0.1, 0.1))
}
try_foo(h = 0.001)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.3, 0.3),
ylim = c(-0.3, 0.3))
}
try_foo(h = 0.01)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.3, 0.3),
ylim = c(-0.3, 0.3))
}
try_foo(h = 0.02)
try_foo <- function(Tt = 4, n = 160, sigma = 0.75, h = 0.01)
{
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
N  <-  Tt/h
tk  <-  seq(0, Tt, h)
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]], type = "l",
xlim = c(-0.05, 0.15),
ylim = c(-0.05, 0.25))
}
try_foo(h = 0.02)
try_foo(h = 0.01)
try_foo(h = 0.005)
try_foo(h = 0.01)
library("rgl") # plot3d
library("circlize") # random colors
addTaskCallback(function(...) {set.seed(1337);TRUE})
### Initial data
Tt  <-  4
n  <-  160
sigma  <-  0.75
h  <-  0.01
z  <-  2.5
#####
N  <-  Tt/h
N
tk  <-  seq(0, Tt, h)
tk
pair.func <- function()
{
pair  <-  t(simplify2array(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = F)))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
###1
pairs.list <- replicate(n, pair.func(), F)
plot(pairs.list[[1]][1:200])
plot(pairs.list[[1]], type = "n")
lines(pairs.list[[1]][1:200], type = "l", col = "lightblue")
pairs.list[[1]][1:200]
lines(pairs.list[[1]][1:200], type = "l")
lines(pairs.list[[1]], type = "l")
pairs.list[[1]]
pairs.list[[1]][1:200,]
lines(pairs.list[[1]][1:200,], type = "l", col = "lightblue")
lines(pairs.list[[1]][1:200,], type = "l", col = "red")
lines(pairs.list[[1]][201:400,], type = "l", col = "red")
lines(pairs.list[[1]][1:200,], type = "l", col = "lightblue")
lines(pairs.list[[1]][201:400,], type = "l", col = "red")
plot(pairs.list[[1]], type = "n")
lines(pairs.list[[1]][1:200,], type = "l", col = "lightblue")
lines(pairs.list[[1]][201:400,], type = "l", col = "red")
plot(pairs.list[[1]], type = "n")
lines(pairs.list[[1]][1:200,], type = "l", col = "lightblue")
lines(pairs.list[[1]][200:400,], type = "l", col = "red")
plot(pairs.list[[1]], type = "n")
plot(pairs.list[[1]], type = "L")
plot(pairs.list[[1]], type = "l")
png(filename = "../img/2d_6.png",
width = 1920, height = 1080,
res = 96 * 2)
plot(pairs.list[[6]], type = "l", main = "Trajectory 6, h = 0.02",
xlab = "", ylab = "")
dev.off()
png(filename = "../img/2d_70.png",
width = 1920, height = 1080,
res = 96 * 2)
plot(pairs.list[[70]], type = "l", main = "Trajectory 70, h = 0.02",
xlab = "", ylab = "")
dev.off()
png(filename = "../img/2d_140.png",
width = 1920, height = 1080,
res = 96 * 2)
plot(pairs.list[[140]], type = "l", main = "Trajectory 140, h = 0.02",
xlab = "", ylab = "")
dev.off()
var_foo <- function(y)
{
sum(abs(diff(y)))
}
vars <- t(sapply(pairs.list, function(x) apply(x, 2, var_foo)))
head(vars,5)
tail(vars,5)
mean_vars <- colMeans(vars)
mean_vars
sq.var_foo <- function(y)
{
sum(abs(diff(y))^2)
}
sq.vars <- t(sapply(pairs.list, function(x) apply(x, 2, sq.var_foo)))
head(sq.vars,5)
tail(sq.vars,5)
mean_sq.vars <- colMeans(vars)
mean_sq.vars
source("./h_dvd_2.R", echo = T)
library("rgl") # plot3d
library("circlize") # random colors
library("psych")
library("data.table")
library("zoo")
library("scales")
addTaskCallback(function(...) {set.seed(1337);TRUE})
### Начальные данны
Tt  <-  4
n  <-  160
sigma  <-  0.75
h  <-  0.01
z  <-  2.5
#####
N  <-  Tt/h
N
# Формирование одной траектории
pair.func <- function()
{
pair  <-  t(replicate(N,
sapply(c(1,2), function(y) rnorm(1, 0, h * sigma^2)),
simplify = T))
return(apply(rbind(c(0,0),pair), 2, cumsum))
}
###1
pairs.extnd.list <- replicate(n, pair.func(), F)
# tmpr <- replicate(n, rbind(c(0,0),
#                         rollapply(pair.func(), 2, by = 2, sum)), F)
# pairs.list <- Map(function(x, y) scales::rescale(x, to = range(y)),
#                   tmpr, pairs.extnd.list)
pairs.list <- Map(function(x) x[c(T,F),], pairs.extnd.list)
head(pairs.list[[1]], 4)
head(pairs.list[[6]],4)
tail(pairs.list[[6]],4)
source("./h_dvd_2.R", echo = T)
plot(pairs.list[[1]], type = "l", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
dev.off()
plot(pairs.list[[1]], type = "l", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.extnd.list[[1]], type = "l", col = "blue")
lines(pairs.extnd.list[[1]][100:120,], type = "l", col = "blue")
plot(pairs.list[[1]][[1:10,]], type = "l", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
plot(pairs.list[[1]][[,1:10]], type = "l", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
plot(pairs.list[[1]][[1:10,]], type = "l", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
plot(pairs.list[[1]][1:10,], type = "l", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.extnd.list[[1]][1:20,], type = "l", col = "blue")
plot(pairs.list[[1]][1:10,], type = "l", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
plot(pairs.list[[1]][1:10,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][1:20,], type = "l", col = "blue")
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][1:20,], type = "l", col = "blue")
lines(pairs.list[[1]][1:10,], type = "l", col = "green")
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l", col = "green")
lines(pairs.extnd.list[[1]][1:20,], type = "l", col = "blue")
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][1:20,], type = "l", col = "blue")
lines(pairs.extnd.list[[1]][1:21,], type = "l", col = "blue")
lines(pairs.extnd.list[[1]][1:20,], type = "l", col = "blue")
lines(pairs.list[[1]][1:10,], type = "l")
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][1:20,], type = "l", col = "blue")
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][1:19,], type = "l", col = "blue")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][2:19,], type = "l", col = "blue")
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][2:19,], type = "l", col = "blue")
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][2:10,], type = "l")
lines(pairs.extnd.list[[1]][1:19,], type = "l", col = "blue")
lines(pairs.list[[1]][1:10,], type = "l")
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][1:19,], type = "l", col = "blue")
plot(pairs.list[[1]], type = "l")
lines(pairs.extnd.list[[1]], type = "l", col = "blue")
png(filename = "../img/2d_1_1.png",
width = 1920, height = 1080,
res = 96 * 2)
plot(pairs.list[[1]], type = "l")
lines(pairs.extnd.list[[1]], type = "l", col = "blue")
dev.off()
png(filename = "../img/2d_1_1_reduced.png",
width = 1920, height = 1080,
res = 96 * 2)
plot(pairs.extnd.list[[1]][1:20,], type = "n", main = "Trajectory 1, h = 0.02, 0.01",
xlab = "", ylab = "")
lines(pairs.list[[1]][1:10,], type = "l")
lines(pairs.extnd.list[[1]][1:19,], type = "l", col = "blue")
dev.off()
compare_table <- data.table(vars = vars.extnd)
compare_table
compare_table <- data.table(mean_vars = mean_vars.extnd)
compare_table
compare_table <- data.table(mean_vars = mean_vars.extnd,
mean_sq = mean_sq.vars.extnd )
compare_table
compare_table <- data.table(mean_vars = mean_vars,
mean_vars.extnd = mean_vars.extnd,
mean_sq = mean_sq.vars.extnd,
mean_sq.vars.extnd = mean_sq.vars.extnd)
compare_table
mean_vars.extnd
mean_sq.vars.extnd
mean_sq.vars.extnd
compare_table <- data.table(mean_vars = mean_vars,
mean_vars.extnd = mean_vars.extnd,
mean_sq = mean_sq.vars,
mean_sq.vars.extnd = mean_sq.vars.extnd)
compare_table <- data.table(mean_vars = mean_vars,
mean_vars.extnd = mean_vars.extnd,
mean_sq = mean_sq.vars,
mean_sq.vars.extnd = mean_sq.vars.extnd)
compare_table
mean_sq.vars
sq.var_foo <- function(y)
{
sum(abs(diff(y))^2)
}
sq.vars <- t(sapply(pairs.list, function(x) apply(x, 2, sq.var_foo)))
head(sq.vars,5)
tail(sq.vars,5)
mean_sq.vars <- colMeans(vars)
mean_sq.vars
sq.vars.extnd  <- t(sapply(pairs.extnd.list, function(x) apply(x, 2, sq.var_foo)))
head(sq.vars.extnd ,5)
tail(sq.vars.extnd ,5)
mean_sq.vars.extnd  <- colMeans(vars.extnd )
mean_sq.vars.extnd
mean_sq.vars.extnd
tail(sq.vars.extnd ,5)
tail(sq.vars ,5)
mean(sq.vars)
mean(sq.vars.extnd)
colMeans(vars.extnd )
colMeans(vars)
sq.vars.extnd
mean_sq.vars <- colMeans(sq.vars)
mean_sq.vars
mean_sq.vars.extnd  <- colMeans(sq.vars.extnd )
compare_table <- data.table(mean_vars = mean_vars,
mean_vars.extnd = mean_vars.extnd,
mean_sq.vars = mean_sq.vars,
mean_sq.vars.extnd = mean_sq.vars.extnd)
compare_table
var_foo <- function(y)
{
sum(abs(diff(y)))
}
vars <- t(sapply(pairs.list, function(x) apply(x, 2, var_foo)))
head(vars,5)
tail(vars,5)
mean_vars <- colMeans(vars)
mean_vars
#
sq.var_foo <- function(y)
{
sum(abs(diff(y))^2)
}
sq.vars <- t(sapply(pairs.list, function(x) apply(x, 2, sq.var_foo)))
head(sq.vars,5)
tail(sq.vars,5)
mean_sq.vars <- colMeans(sq.vars)
mean_sq.vars
vars.extnd <- t(sapply(pairs.extnd.list, function(x) apply(x, 2, var_foo)))
head(vars.extnd,5)
tail(vars.extnd,5)
mean_vars.extnd <- colMeans(vars.extnd)
mean_vars.extnd
sq.vars.extnd  <- t(sapply(pairs.extnd.list, function(x) apply(x, 2, sq.var_foo)))
head(sq.vars.extnd ,5)
tail(sq.vars.extnd ,5)
mean_sq.vars.extnd  <- colMeans(sq.vars.extnd )
mean_sq.vars.extnd
compare_table <- data.table(mean_vars = mean_vars,
mean_vars.extnd = mean_vars.extnd,
mean_sq.vars = mean_sq.vars,
mean_sq.vars.extnd = mean_sq.vars.extnd)
compare_table
compare_table$mean_vars/compare_table$mean_vars.extnd
1.276429*0.7083788
1.276429*1.7083788
1.276429/1.801902
compare_table$mean_sq.vars / compare_table$mean_sq.vars.extnd
